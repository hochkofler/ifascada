{
    "agent_id": "test-agent-rs232",
    "mqtt": {
        "host": "localhost",
        "port": 1883
    },
    "printer": {
        "enabled": true,
        "host": "localhost",
        "port": 9100
    },
    "tags": [
        {
            "id": "scale_1",
            "driver": "RS232",
            "driver_config": {
                "port": "COM6",
                "baud_rate": 9600,
                "data_bits": 8,
                "parity": "None",
                "stop_bits": 1,
                "timeout_ms": 500
            },
            "description": "RS232 Scale (Full Feature: ScaleParser + Print)",
            "value_type": "Composite",
            "update_mode": {
                "type": "OnChange",
                "debounce_ms": 500,
                "timeout_ms": 5000
            },
            "pipeline": {
                "parser": {
                    "type": "Custom",
                    "name": "ScaleParser"
                },
                "validators": []
            },
            "automations": [
                {
                    "name": "AccumulateWeight",
                    "trigger": {
                        "type": "ConsecutiveValues",
                        "target_value": 0.0,
                        "count": 1,
                        "operator": "Greater",
                        "within_ms": 1000
                    },
                    "action": {
                        "type": "AccumulateData",
                        "session_id": "scale_session_1",
                        "template": "ignored_for_now"
                    }
                },
                {
                    "name": "PrintBatchOutcome",
                    "trigger": {
                        "type": "ConsecutiveValues",
                        "target_value": 0.0,
                        "count": 2,
                        "operator": "Equal",
                        "within_ms": 5000
                    },
                    "action": {
                        "type": "PrintBatch",
                        "session_id": "scale_session_1",
                        "header_template": "LOTE DE PESAJES",
                        "footer_template": "FIN DEL LOTE"
                    }
                }
            ]
        },
        {
            "id": "scale_2",
            "driver": "RS232",
            "driver_config": {
                "port": "COM2",
                "baud_rate": 9600,
                "data_bits": 8,
                "parity": "None",
                "stop_bits": 1,
                "timeout_ms": 500
            },
            "description": "RS232 Scale (Full Feature: ScaleParser + Print)",
            "value_type": "Composite",
            "update_mode": {
                "type": "OnChange",
                "debounce_ms": 500,
                "timeout_ms": 5000
            },
            "pipeline": {
                "parser": {
                    "type": "Custom",
                    "name": "ScaleParser"
                },
                "validators": []
            },
            "automations": [
                {
                    "name": "AccumulateWeight",
                    "trigger": {
                        "type": "ConsecutiveValues",
                        "target_value": 0.0,
                        "count": 1,
                        "operator": "Greater",
                        "within_ms": 1000
                    },
                    "action": {
                        "type": "AccumulateData",
                        "session_id": "scale_session_2",
                        "template": "ignored_for_now"
                    }
                },
                {
                    "name": "PrintBatchOutcome",
                    "trigger": {
                        "type": "ConsecutiveValues",
                        "target_value": 0.0,
                        "count": 2,
                        "operator": "Equal",
                        "within_ms": 5000
                    },
                    "action": {
                        "type": "PrintBatch",
                        "session_id": "scale_session_2",
                        "header_template": "LOTE DE PESAJES",
                        "footer_template": "FIN DEL LOTE"
                    }
                }
            ]
        },
        {
            "id": "scale_3",
            "driver": "RS232",
            "driver_config": {
                "port": "COM3",
                "baud_rate": 9600,
                "data_bits": 8,
                "parity": "None",
                "stop_bits": 1,
                "timeout_ms": 500
            },
            "description": "RS232 Scale (Full Feature: ScaleParser + Print)",
            "value_type": "Composite",
            "update_mode": {
                "type": "OnChange",
                "debounce_ms": 500,
                "timeout_ms": 5000
            },
            "pipeline": {
                "parser": {
                    "type": "Custom",
                    "name": "ScaleParser"
                },
                "validators": []
            },
            "automations": [
                {
                    "name": "AccumulateWeight",
                    "trigger": {
                        "type": "ConsecutiveValues",
                        "target_value": 0.0,
                        "count": 1,
                        "operator": "Greater",
                        "within_ms": 1000
                    },
                    "action": {
                        "type": "AccumulateData",
                        "session_id": "scale_session_3",
                        "template": "ignored_for_now"
                    }
                },
                {
                    "name": "PrintBatchOutcome",
                    "trigger": {
                        "type": "ConsecutiveValues",
                        "target_value": 0.0,
                        "count": 2,
                        "operator": "Equal",
                        "within_ms": 5000
                    },
                    "action": {
                        "type": "PrintBatch",
                        "session_id": "scale_session_3",
                        "header_template": "LOTE DE PESAJES",
                        "footer_template": "FIN DEL LOTE"
                    }
                }
            ]
        }
    ]
}