{
    "agent_id": "test-agent-rs232",
    "mqtt": {
        "host": "localhost",
        "port": 1883
    },
    "tags": [
        {
            "id": "rs232_raw_mettler",
            "driver": "RS232",
            "driver_config": {
                "port": "COM1",
                "baud_rate": 9600,
                "data_bits": 8,
                "parity": "None",
                "stop_bits": 1,
                "timeout_ms": 1000
            },
            "description": "RS232 Balance (Raw String - COM1)",
            "value_type": "Simple"
        },
        {
            "id": "rs232_parsed_temp",
            "driver": "RS232",
            "driver_config": {
                "port": "COM2",
                "baud_rate": 9600,
                "data_bits": 8,
                "parity": "None",
                "stop_bits": 1,
                "timeout_ms": 1000
            },
            "description": "RS232 Temp (Regex Parsed - COM2)",
            "value_type": "Simple",
            "pipeline": {
                "parser": {
                    "type": "Regex",
                    "pattern": "TEMP:\\s*([\\d.]+)\\s*C"
                },
                "validators": []
            }
        },
        {
            "id": "rs232_range_ok",
            "driver": "RS232",
            "driver_config": {
                "port": "COM3",
                "baud_rate": 19200,
                "data_bits": 8,
                "parity": "None",
                "stop_bits": 1,
                "timeout_ms": 1000
            },
            "description": "RS232 Range Validated (COM3)",
            "pipeline": {
                "validators": [
                    {
                        "type": "Range",
                        "min": 0.0,
                        "max": 100.0
                    }
                ]
            }
        },
        {
            "id": "rs232_range_fail",
            "driver": "RS232",
            "driver_config": {
                "port": "COM4",
                "baud_rate": 9600,
                "data_bits": 8,
                "parity": "Even",
                "stop_bits": 1,
                "timeout_ms": 1000
            },
            "description": "RS232 Range Validated (Fail - COM4)",
            "pipeline": {
                "validators": [
                    {
                        "type": "Range",
                        "min": 0.0,
                        "max": 100.0
                    }
                ]
            }
        },
        {
            "id": "rs232_composite_json",
            "driver": "RS232",
            "driver_config": {
                "port": "COM5",
                "baud_rate": 115200,
                "data_bits": 8,
                "parity": "None",
                "stop_bits": 1,
                "timeout_ms": 2000
            },
            "description": "RS232 Composite JSON (COM5)",
            "value_type": "Composite",
            "pipeline": {
                "parser": {
                    "type": "Json",
                    "path": ""
                }
            }
        },
        {
            "id": "rs232_scale_full",
            "driver": "RS232",
            "driver_config": {
                "port": "COM6",
                "baud_rate": 9600,
                "data_bits": 8,
                "parity": "None",
                "stop_bits": 1,
                "timeout_ms": 500
            },
            "description": "RS232 Scale (Full Feature: ScaleParser + Print)",
            "value_type": "Composite",
            "pipeline": {
                "parser": {
                    "type": "Custom",
                    "name": "ScaleParser"
                },
                "validators": []
            },
            "automations": [
                {
                    "name": "AutoPrint",
                    "trigger": {
                        "type": "ConsecutiveValues",
                        "target_value": 0.0,
                        "count": 2,
                        "operator": "LessOrEqual",
                        "within_ms": 5000
                    },
                    "action": {
                        "type": "PrintTicket",
                        "template": "weight_ticket_v1",
                        "service_url": "http://localhost:9000/api/print"
                    }
                }
            ]
        }
    ]
}